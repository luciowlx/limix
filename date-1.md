数据预处理任务通过 三步 完成配置，包括：选择数据集、字段选择、规则配置。以下对每一步的输入项、用户操作、系统行为、输出结构及字段说明进行详细描述，并列出特殊场景下的处理。用户角色权限方面，仅拥有“数据预处理任务创建”权限的用户（默认普通用户可在自己项目中执行，高级用户可在部门共享项目中执行，管理员不受限）才可新建预处理任务。

第一步：选择数据集

输入项：当前项目下可用的数据集列表（含各数据集的版本信息）。每条数据集记录包含名称、版本号、描述、记录条数、字段数、文件大小等元数据。提供搜索框用于名称模糊搜索筛选数据集。

用户操作：

在数据集列表中勾选一个或多个数据集（支持多选场景，通常选择单个数据集；多选用于数据拼接等场景）。可使用“全选/清空”按钮批量选择或清除。若使用了搜索过滤，“全选”作用于过滤结果。

（可选）当同一数据有多个版本时，可展开其版本列表选择特定版本。支持同时选择不同数据集的不同版本进行联合预处理。

确认选择完成后，点击对话框底部的“下一步”按钮进入下一阶段。

系统行为：

数据集列表显示：按创建时间倒序排列不同数据集；同一数据集下各版本按版本号倒序（最新版本优先）。列表项显示主要字段：数据集名称、版本号、描述、记录条数、字段数量、文件大小等。支持根据用户输入实时过滤列表。

选择状态更新：用户勾选数据集后，下方显示已选数据集标签（名称 + 版本）。若选择了多个数据集，标签可切换预览不同数据集。再次点击标签的关闭按钮可移除已选的数据集。

数据预览区域：当有选中数据集时，界面下方展开预览面板显示该数据集的详细信息和数据示例：包括数据集名称、版本、记录条数、字段数、文件大小、创建时间、描述等元信息，以及数据表的预览内容。默认预览前 10 行数据；如字段很多，可横向滚动查看；如记录很多，可通过分页控件调整每页显示数并翻页浏览。

多数据集选择处理：当选中了多个数据集时，系统要求用户指定其中一个作为主表（其余作为辅表）。界面出现“主表选择”下拉框列出已选数据及版本，用户必须选择主表后才能进行下一步。此时预览区域默认展示多个数据集的公共字段视图（即仅显示所有选定数据都包含的字段）；用户可切换查看“全部字段”视图（显示所有选定数据的字段全集）。如果公共字段集合为空，提示用户切换到全部字段视图或重新选择数据集组合。

输出结构：进入第二步时，系统将携带用户所选的数据集清单及其版本信息，并记录主表标识（多数据集场景）。后续步骤可获取所选数据集的元数据和预览数据。例如，系统以 JSON 形式暂存选择结果，如：

{
  "datasets": [
    {"id": "dataset_1", "version": "v3"},
    {"id": "dataset_2", "version": "v1"}
  ],
  "primary_dataset": "dataset_1"
}


（以上结构表示选中了两个数据集，其中 dataset_1 的版本3为主表。）

关键字段说明：数据集列表及预览区域涉及的主要字段如下：

字段名	含义
数据集名称	数据集的名称（唯一标识）
版本号	数据集版本标识，如 v1, v2
描述	数据集的简要描述信息
记录条数	数据集中包含的数据行数
字段数量	数据集包含的字段（列）总数
文件大小	数据集文件存储大小
创建时间	该数据集版本的创建时间

边界与异常场景：

若当前项目下无任何数据集可供选择，列表为空，“下一步”按钮置灰不可用。需提示用户先上传或订阅数据。

若用户未选择任何数据集就试图进入下一步，系统应提示“请选择至少一个数据集”。

当多选多个版本的同一数据集进行处理时，视作多个独立数据来源处理（类似多数据集场景）。

多数据集合并时，如辅表中存在主表没有的记录（无匹配键值），系统仅以主表为基准进行合并（主表记录全部保留，无法匹配的辅表记录被忽略），并在预处理结果日志中记录未匹配情况。

数据集名称或描述过长时，列表中应截断显示并提供悬停提示全名。

第二步：字段选择

输入项：来自步骤一的已选数据集及其字段信息。系统解析所选数据源的表结构，准备字段列表，包括字段名及类型、各字段的统计信息（空值率、重复率、唯一值比例等）和示例数据等。

用户操作：

查看系统呈现的字段列表，勾选需要保留的字段（复选框）。默认全选所有字段。用户可通过取消勾选来排除不需要的字段；只有勾选的字段会进入后续的预处理流程，未选中的字段将从数据集中删除。

如有需要，修改字段名称：点击字段名文本可进行编辑。仅允许英文字母、数字及下划线等标准字符，禁止输入空格和非英文字符。修改后即时更新字段列表展示，并将使用新名称参与后续处理。

检查/调整字段类型：查看系统自动推断的数据类型（数值型、字符型、布尔型等），对于混合类型字段（例如同时含有数值和字符串），界面会以高亮或提示标注。用户需从下拉菜单中选择最终类型（如将混合内容列明确设置为“字符型”或“数值型”），也可以统一调整字段类型（例如将某些字段强制转换为字符串类型）。

（多数据集场景）确认主表选择及字段视图：如上一步选了多个数据，确保已选择主表且当前视图（公共字段或全部字段）符合预期。用户可在“全部数据列”模式下看到各数据源的所有字段，并决定勾选哪些进入主表。主表中不存在的辅表字段如果被选中，在合并时将产生空值。

完成字段选择和设置后，点击“下一步”进入规则配置阶段。

系统行为：

字段列表展示：系统根据所选数据集加载字段信息。如果是单一数据集，直接列出该数据集的所有字段。如果是多数据集，默认显示公共字段列表，并在列表顶部提供“公共字段/全部字段”视图切换按钮。切换到“全部字段”时，列表将显示所有字段，并可标记字段来源（例如字段后标注所属数据集名称），以便用户区分同名字段。

主表设定：对于多数据源，系统已记录主表。字段列表中主表的字段名正常显示，辅表的非公共字段在公共字段视图下默认不显示，在全部字段视图下显示且未选中状态（用户可主动选中这些字段加入结果，但其在主表记录中会出现空值）。

统计信息计算：系统自动计算并展示每个字段的质量指标：

空值率：该字段空值（如 NULL、空字符串）的数量占总记录数的比例（百分比）。

重复率：完全相同值重复出现的记录数占总记录数的比例。

唯一值比例：该字段取值在总体中唯一出现的数量比例（反映信息密度）。

示例值：显示该字段前若干行的实际值样本（默认取前 5 行），用于让用户直观了解数据内容。

类型推断与警告：系统根据字段内容推断类型；对检测出内容混杂多种形式的列，标记为“类型不一致”并提示用户选择类型。用户一旦在界面修改类型，下方相关统计可能更新（如将某列设为数值型，则系统可能重新计算其空值率等）。

字段名编辑校验：当用户修改字段名后，系统立即校验合法性：只允许英文字母、数字、下划线，且不能为空或与现有其他字段名冲突。非法输入时，字段名编辑框边框高亮为红色并提示错误（如“字段名只能包含字母、数字或下划线，且必须唯一”），不允许进入下一步。

字段选择校验：进入下一步前，至少需保留一列字段（主表需至少一列）。若用户将所有字段取消勾选，系统禁止继续并提示“请至少选择一列进行预处理”。

多数据源合并逻辑：在用户点击“下一步”时，如果存在多数据集：系统将按照主表定义对数据进行合并准备：以主表为基准建立记录集，通过同名字段进行记录匹配（内联或左联接）。若辅表存在主表没有的字段且用户选择保留，该字段在主表所有记录上填充空值；若辅表有主表没有的记录行，则这些记录不纳入主表（相当于忽略无匹配的辅表行）。合并逻辑在后台执行，并在下一步配置时依据选择后的字段生成规则模板。

输出结构：完成第二步后，系统生成“字段选择结果”数据结构传递给规则配置步骤。其中包含：最终保留的字段列表及其元信息（新字段名、类型）、主表与辅表字段映射关系（多数据时），以及需要删除的字段列表等。例如：

{
  "selected_fields": [
    {"name": "FieldA_new", "type": "string", "source": "dataset_1"},
    {"name": "FieldB", "type": "int", "source": "dataset_1"},
    {"name": "FieldC", "type": "float", "source": "dataset_2"}
  ],
  "dropped_fields": [...],
  "primary_dataset": "dataset_1"
}


（以上表示保留了三个字段，其中FieldA_new是来自主数据集dataset_1的字段被重命名，另有一个字段来自辅表dataset_2。系统记录了删除字段和主表标识。）

关键字段说明：字段选择界面中各列含义如下：

列名	含义及操作
选择列	复选框，用于选择保留该字段。未选中的字段将在预处理时被丢弃。
字段名	原始字段名称。支持用户点击编辑名称（限制使用英文字母/数字/下划线）。
类型	系统推断的数据类型（如整型、浮点、字符串、布尔）。支持用户从下拉框修改类型。
空值率	该字段为空值的比例（%）。用于评估缺失值影响，指导是否需要填充或删除操作。
重复率	该字段完全重复值的比例（%）。用于识别重复数据，以避免模型训练受到冗余样本影响。
唯一值比例	该字段取值在总体中仅出现一次的比例（%）。反映信息密度，比例过高表示大多值不重复，可能难以提取通用模式。
示例值	该字段部分样本值示例，用于直观展示数据内容格式。

边界与异常场景：

如果步骤一选的是多个数据集但没有任何公共字段，系统在“公共字段”视图下会显示为空，并提示用户切换到“全部字段”视图自行选择需要的字段参与合并。

如果用户在“全部字段”视图选择了辅表中特有的字段，合并后这些字段在主表不对应的记录上将为空，在预处理结果中计入缺失值。建议系统在用户勾选此类字段时警告：“选中的字段在主表缺少对应值，合并后该字段将含有空值”。

字段类型选择错误可能导致后续规则无法应用（例如将日期字符串误设为数值型）。系统在进入第三步前，可对明显不合理的类型配置给出提示（如“字段X可能包含日期，请确认类型设置”）。

字段重命名若与已有字段名冲突（含原始字段和用户已改名的字段），系统应阻止并提示冲突，需要用户修改为唯一名称后再继续。

在字段很多的情况下（几十上百列），界面应支持列表的垂直滚动，并提供字段快速筛选或搜索功能，方便用户定位特定字段进行选择。

第三步：规则配置

输入项：来自步骤二的选定字段列表和数据集合并结果。系统根据这些输入初始化预处理规则配置界面，包括智能推荐的清洗策略列表、用户可编辑的清洗规则列表，以及规则的 JSON 配置视图（高级模式）。

用户操作：

查看智能推荐清洗策略：页面上方首先展示“智能推荐清洗策略”板块。用户可浏览由 LimiX 大模型分析自动生成的数据问题清单和建议处理方案（如缺失值填充建议、去重建议等，详见下文字段说明）。针对每条推荐策略，用户可以勾选“应用此策略”，系统将自动将对应的清洗规则添加到下方的规则列表中。用户也可点击查看详细说明（大模型给出的原因和预期效果）。另外，界面提供“LLM 指令对话”入口，支持用户通过自然语言指令定制清洗策略（如用户输入“请删除异常值超过5%的列”，系统解析指令并相应添加规则）。

配置清洗规则：在“清洗规则”列表区域，用户可以新增、编辑或移除具体的预处理规则。每条规则以卡片形式展示，包含规则类型选择和相应参数输入项：

点击“添加规则”按钮，新增一条规则卡片。

在规则卡片中，选择字段（从步骤二保留的字段中选择目标列）。

选择规则类型（下拉框，提供多种预处理规则类型，如“缺失值填充”、“字符编码”、“去重”、“数值标准化”等）。选择不同类型后，卡片会动态显示该类型所需的参数项输入区域。

根据所选规则类型，填写或选择所需的参数值（例如，若选择“缺失值填充”，则需选择填充方式并提供填充值；选择“格式化日期”，则需指定日期格式等）。

如需删除某条规则，点击规则卡片上的“移除”按钮（一般以🗑图标表示）。

用户可以通过拖拽或上下箭头调整规则卡片的执行顺序（如果顺序会影响结果，例如先填充缺失再标准化）。

查看/编辑高级JSON（可选）：有经验的用户可点击“高级配置”或“JSON配置”按钮，展开 JSON 编辑器视图。此时系统会将当前配置的清洗规则列表转换为 JSON 格式显示出来。用户可直接编辑 JSON 来增删或修改规则配置。

编辑 JSON 后可点击“校验配置”按钮，系统将解析 JSON 并进行格式和参数合法性校验。若 JSON 格式错误或参数无效，界面突出显示错误位置并给出提示（如“JSON格式错误”或具体哪项参数不合法）。只有当 JSON 内容校验通过时，才能保存或执行。

JSON 编辑器与UI表单是双向同步的：用户若通过JSON进行了修改，并保存/应用，UI上的规则列表应随之更新；反之，当用户通过UI添加/修改规则时，JSON视图内容也实时更新。

确认执行：完成规则配置后，点击“开始清洗”或“执行”按钮。系统会弹出确认提示（列出将应用的规则概览），用户确认后正式提交任务。执行期间，页面显示清洗任务的进度条和日志输出区域，实时反馈执行状况。

任务进度条显示整体进度百分比，各规则执行完毕会更新进度。

日志区域按步骤输出关键日志信息（例如：“[10%] 检测缺失值... 完成”，“[30%] 缺失值填充完成”，“[60%] 文本标准化完成”，直到100%）。

用户可在执行过程中查看日志以了解处理详情，必要时可以选择中止任务（需二次确认）。

查看结果：预处理任务执行成功后，系统自动跳转或打开新数据版本详情页展示结果：包括版本基本信息、新旧字段统计对比、应用的规则列表摘要等。用户可以在该页面验证数据预处理效果，并可通过“版本对比”功能与原始版本进行差异比对（字段变动、统计指标变化、所用规则差异等）。

系统行为：

智能推荐策略生成：进入规则配置界面时，系统调用 LimiX 大模型对选定的数据集进行分析，生成一组推荐的清洗策略。每条策略包含系统检测到的数据问题及建议的解决方案。具体字段结构如下（由 LimiX 提供）：

字段	含义
数据问题名称	描述发现的数据问题类别，例如 “数据去重”, “缺失值填充”, “唯一值过高”, “文本标准化”等。
影响程度	问题对数据质量或后续模型的影响等级：高 / 中 / 低。由模型综合评估得出（如结合特征重要性或预设规则确定）。
影响行数	受到该问题影响的数据行数量。例如有多少条记录存在缺失，或多少条记录是重复的。
影响字段	涉及该问题的字段名列表。若多个字段存在此问题，以分号 ; 分隔列出。
推荐处理说明	大模型给出的处理建议及其理由。文本描述例如：“建议对字段X进行缺失值填充，可选择均值填充，提升模型对该字段的利用率”。

系统将上述推荐列表展示给用户，用户可自行决定是否采纳。勾选某项推荐时，系统会自动在下方清洗规则列表中新增对应的规则卡片（初始参数根据推荐方案填好，用户可进一步调整）。

清洗规则列表管理：用户通过UI添加/编辑规则时，系统执行以下逻辑：

根据用户选择的规则类型，动态加载该类型需要的参数输入控件（例如下拉、输入框、复选框等）并附上默认值和校验规则。

参数输入实时校验：如必填项为空则该规则卡片标记错误，不允许执行；数值型参数超出合理范围则提示警告等。

规则顺序调整：系统维护规则执行的顺序列表，在任务执行时严格按照列表顺序应用规则。对于顺序相关的规则，系统在调整时可能提示用户注意先后次序的影响。

规则类型及参数要求：系统支持的预处理规则类型及其配置要求如下（各规则均可通过UI或JSON配置）：

缺失值填充（针对数值或字符字段的空值处理）

参数：

字段名称（必填）：选择要处理缺失值的目标字段。

填充方式（必填）：选择缺失值填补策略。可选项：均值填充、中位数填充、众数填充、自定义值填充、LimiX模型填充。

自定义填充值（当填充方式选“自定义”时必填）：由用户输入的固定值，用于替换该字段中的缺失项。类型应与字段一致；对于数值字段支持输入具体数值，对于字符字段支持输入字符串等。

默认值：无默认填充方式，用户必须显式选择一种方式。

校验：当所选字段缺失率超过预设阈值（如80%）时，系统在配置时给予提示“建议删除该列而非填充”。用户确认选择填充方式时，系统弹出提示“填充可能改变数据分布，请谨慎使用”，需用户确认后才能保存配置。

备注：选择“LimiX模型填充”时，系统将调用 LimiX 模型对该字段缺失值进行智能预测补全（利用该字段与其他特征的关系进行估计）。

字符编码（将分类/枚举型字符数据转换为数值）

参数：

字段名称（必填）：选择需要编码的类别型字段。

编码方法（必填）：选择编码策略。可选项：标签编码（Label Encoding）或 独热编码（One-Hot Encoding）。

默认值：默认无编码，用户需明确选择其一。

校验：当选择 One-Hot 编码且预估生成的哑变量新列数 > 100 时，系统警告：“生成新列过多，计算资源消耗高，建议改用标签编码”。如果管理员在系统配置中设置了One-Hot列数上限，超过限制时系统将禁止选择 One-Hot 并提示原因。

备注：标签编码适用于类别种类较多的情况；One-Hot 适用于类别较少且需要保持各类别独立的情况。系统不允许对数值型字段使用该规则。

去重（删除重复记录）

参数：

字段名称（必填）：选择用于判定重复的字段集。可多选多个字段组合作为联合主键；若留空或不指定具体字段，则默认使用全列内容判定完全重复。

默认值：默认采用所有列进行重复判定（即完全相同的整行数据视为重复）。

校验：配置时如指定多个字段组合，需至少选择1个字段；系统自动忽略空值全部相同但其他字段不同的记录，不将其视为完全重复。

备注：执行该规则时，系统保留首次出现的记录，移除后续重复出现的记录。去重前后记录数变化将记录在日志中。

数值单位标准化（将带单位的数字转为统一单位）

参数：

字段名称（必填）：选择需要规范数值单位的字段（典型为字符串类型字段，包含数字+单位的形式，如“5kg”、“12cm”）。

原始单位（必填）：指定该字段目前使用的单位，例如 kg、cm 等。

目标单位（必填）：期望转换成的单位，例如将kg转换为g，cm转换为m等。需与原始单位量纲相同。

自定义换算表（JSON，选填）：如系统内置的单位换算无法满足需求，用户可提供一个单位换算的JSON配置（例如定义特殊单位与标准单位的换算率）。格式如：{"原单位": {"to":"目标单位", "factor": 1000}}。

默认值：原始单位和目标单位无默认，必须由用户明确填写；自定义换算表默认空（表示使用系统内置换算）。

校验：当用户填写原始/目标单位时，系统校验该单位符号合法且两者可互相转换（量纲一致）。对于提供了自定义JSON的情况，在点击“校验配置”时校验其格式和必要字段。

备注：系统内置常见单位换算，如长度、重量等。执行时会自动扫描字段值，将识别的数值按比例转换到目标单位，并去除原有单位符号。转换后字段类型可标记为数值型。未识别的单位或格式将跳过并在日志警告。

范围值拆分（将表示范围的字段拆分成数值区间）

参数：

字段名称（必填）：选择包含范围表示的字段，如 "年龄: 30-40" 或 "温度: -5～5" 格式。字段类型一般为字符串。

范围格式（必填）：定义范围值的分隔符或格式，例如连接符-或~。可由系统自动检测常见格式，也可由用户指定（如 "10-20" 中的连字符 -）。

保留原始列（布尔，选填）：是否保留原始的范围字段列。默认不保留（即拆分后删除原列），用户可勾选保留以供参考。

默认值：默认不保留原始列。

校验：系统检测所选字段的值格式是否符合指定的范围模式（例如是否包含预期的分隔符）。如果格式不符，提示用户可能需要选择正确的分隔符或无法拆分。

执行逻辑：系统将符合格式的每条记录值按范围拆解为下限值和上限值，生成两个新字段，命名为“原字段名_min”和“原字段名_max”，类型为数值。无法解析的值（不符合格式）在新字段中记为空值并在日志提示。

日期格式化（规范日期时间字段格式）

参数：

字段名称（必填）：选择需要格式转换的日期/时间字段（字符串或日期型）。

日期时间格式（必填）：选择或输入该字段当前使用的日期格式。提供常用格式选项：YYYY-MM-DD、MM/DD/YYYY、DD-MM-YYYY、YYYY-MM-DD HH:mm:ss 等，或选择“自定义”后由用户以格式字符串或正则描述当前格式（支持JSON格式定义复杂日期解析方案）。

默认值：无默认格式，用户需明确选择/输入当前格式。

校验：根据用户选择/提供的格式尝试解析样例值，若解析失败率高，提示格式可能不匹配。

执行逻辑：系统将按指定格式解析字段值，并转换为统一的标准格式存储（如ISO 8601标准时间字符串或时间戳）。对于解析失败的无效日期，如存在“2025-02-30”这种非法日期，系统在执行前弹窗提示用户选择处理方式：删除该行或将该值设为空（两种策略至少选择其一，否则无法继续）。根据用户选择，相应处理反映在规则配置中（如将非法日期替换为缺失值）。

时间序列重采样（针对时间序列数据的频率标准化）

参数：

字段名称（必填）：选择时间序列中的时间戳字段（需为日期时间类型）。

采样频率（必填）：选择重新采样的时间间隔模式。提供选项：中位数间隔、众数间隔、自定义间隔。

自定义间隔值（当选择自定义时必填）：由用户输入期望的时间间隔大小和单位，例如“15 分钟”、“1 天”等。可拆分为数值和单位两个输入项。

默认值：默认选项为“中位数间隔”（系统根据该时间字段相邻记录时间差的中位数作为统一频率）。

校验：当选择自定义间隔时，系统校验时间单位和数值格式正确，例如单位必须是支持的（日、小时、分钟、秒），数值应为正整数。

执行逻辑：系统将根据指定频率重新采样数据记录。例如，对于原始不规则时间点记录，按最近的中位数间隔重新对时间轴取样，缺少的时间点插入空记录（数值字段设为空，分类字段延用上一次值或为空），多余的记录按频率归并（可以取平均或最后值，具体策略视实现而定）。重采样具体方法记录在日志。

数据转换（数值数据的标准化/归一化处理）

参数：

字段名称（必填，可多选）：选择一个或多个需要进行数值变换的字段。用户可一次性选定多个数值列应用相同转换方法。

转换方法（必填）：选择应用的变换类型。可选项包括：对数变换、平方根变换、Box-Cox、Yeo-Johnson、分位数变换。选择不同方法后可填写其特定参数：

对数变换：对数尺度转换（默认自然对数）。无额外参数；若包含非正值，建议先进行偏移或改用 Yeo-Johnson。

平方根变换：对右偏分布数据进行平方根转换以缓解偏态。无额外参数。

Box-Cox：幂变换，适用于正值数据。参数：λ（lambda），留空或不填表示自动估计；填写时需为数值。

Yeo-Johnson：幂变换，可处理包含负值的数据。参数：λ（lambda），留空或不填表示自动估计；填写时需为数值。

分位数变换：通过累积分布函数映射到目标分布。参数：分位数数目 nQuantiles（整数，默认100，需≥2）；输出分布 outputDistribution（uniform/normal）。

默认值：默认无转换（除非模型内部已处理）。用户需明确选择方法；Box-Cox/Yeo-Johnson 的 λ 不填时自动估计；分位数变换默认 nQuantiles=100、输出分布=uniform。

校验：

若用户选择多个字段一起转换，系统需确保这些字段类型均为数值型且转换方法适用，如对类别字段应用数值标准化则提示错误。

对各方法的参数进行基本校验，如自定义区间的最小值应小于最大值；小数移动位数为整数等。

备注：平台默认情况下，模型推理（如 LimiX 模型）内部会对输入数据进行必要的数值标准化处理。如果用户未配置本规则，系统视为使用模型内置预处理。但提供该规则是为了在特殊情况下允许用户手动覆盖模型的默认处理，满足特定业务需求。配置全局应用时，用户一次选择多个字段应用相同转换，系统在JSON中记录批量字段列表以减少重复配置。

规则类型统一命名与配置项规范（补充）

为确保与前端 UI 下拉项和后端 JSON 配置完全一致，统一约定如下：

一、规则对象通用结构
- id: string（系统生成）
- source: recommended | custom
- type: 见下方规则类型标识
- fields: string[]（允许单字段或多字段；部分规则仅支持单字段）
- config: object（各规则的参数集合，详见各规则规范）
- enabled: boolean（默认 true）
- order: number（执行顺序，越小越先）

二、规则类型标识与 UI 文案映射
- MissingValueFill（缺失值填充）
- Deduplicate（去重）
- DateFormat（格式化日期）
- TextNormalize（文本标准化）
- RangeValidate（范围验证）
- ScaleLimit（量程）
- Encoding（字符编码）
- UnitNormalize（数值单位标准化）
- RangeSplit（范围值拆分）
- TimeResample（时间序列重采样）
- NumericTransform（数值转换）
- CustomRule（自定义规则）

三、各规则配置项规范
1) 文本标准化（TextNormalize）
- fields: 单字段或多字段（字符串型）
- config:
  - convertCase: none | lower | upper | title（默认 none）
  - trimWhitespace: boolean（默认 true）
  - normalizeUnicode: NFC | NFD | NFKC | NFKD | none（默认 NFC）
  - removeNonASCII: boolean（默认 false）
  - removePunctuation: boolean（默认 false）
  - collapseSpaces: boolean（默认 true，连续空格折叠为一个）
- 校验：仅允许字符串型字段；若 fields 中含非字符串列则报错
- 执行：按配置依序处理；不可逆改动在日志记录

2) 范围验证（RangeValidate）
- fields: 单字段（数值型或日期型）
- config:
  - min: number | string（日期型可为ISO字符串）
  - max: number | string
  - inclusiveMin: boolean（默认 true）
  - inclusiveMax: boolean（默认 true）
  - outOfRangeAction: set_null | clip | drop_row | warn_only（默认 set_null）
- 校验：要求 min < max；日期需能解析；当选择 clip 时为数值型字段才允许
- 执行：根据策略对越界值置空/截断/删除并记录数量

3) 量程（ScaleLimit）
- fields: 单字段（通常为传感器或度量字段）
- config:
  - lowerBound: number（必填）
  - upperBound: number（必填）
  - unit: string（选填；如与 UnitNormalize 结合使用）
  - outOfRangeAction: set_null | clip | drop_row（默认 clip）
  - applyTemplate: string（选填，按行业预设量程模板，如“温度_工业标准”）
- 校验：lowerBound < upperBound；若提供 unit 则需与数据单位一致或已通过 UnitNormalize 转换
- 执行：与 RangeValidate 相同，但强调行业量程模板的可复用

4) 自定义规则（CustomRule）
- fields: 可选（取决于规则内容）
- config:
  - dsl: object | string（必填，JSON或特定DSL）
  - description: string（选填）
  - failPolicy: abort | skip | warn（默认 abort）
- 校验：必须能被后端解析并通过校验；不允许危险操作（如删除全部列）
- 执行：由后端解析执行；前后端需保留原始DSL在任务记录

5) 字符编码（Encoding，类别编码）
- fields: 单字段（分类/枚举型或字符串型，唯一值数量不超过阈值）
- config:
  - method: one_hot | label | target | frequency（默认 one_hot）
  - handleUnknown: error | ignore | create_new_category（默认 create_new_category）
  - dropFirst: boolean（默认 false，One-Hot 时是否丢弃首个以避免共线性）
  - minFrequency: number（默认 1，仅 frequency 编码时用于聚合低频类别）
- 校验：要求字段可视为类别型；当唯一值过多时给出警告或禁止 one_hot
- 执行：对分类字段进行数值化编码，记录类别映射表以便下游复现

补充：异常值处理（OutlierHandling）
- type: OutlierHandling
- fields: 单字段或多字段（数值型）
- config:
  - method: zscore | iqr | percentile
  - threshold: number（当 method=zscore 时如 3；当 iqr 时倍数如 1.5；当 percentile 时提供上下分位，如 [1,99]）
  - action: set_null | clip | drop_row（默认 set_null）
- 校验：字段类型必须为数值；阈值需合法
- 执行：计算异常阈值并按策略处理

四、JSON校验与错误处理
- 所有规则在保存与执行前进行 schema 校验；缺失必填项或类型不匹配时禁止提交
- 前端 UI 表单与 JSON 编辑器保持双向同步；配置被解析为上述统一结构
- 任务执行日志必须包含每条规则的处理数量及异常条目统计

以上规范与现有章节保持一致，并补齐了“文本标准化 / 范围验证 / 量程 / 自定义规则 / 异常值处理”等规则的定义与参数。

JSON配置同步：当用户在高级JSON编辑器中修改配置并校验通过后，系统即时更新UI的规则列表呈现。反之亦然，保持两种配置界面内容的一致性。保存时系统会将最终规则集合序列化为JSON存储，格式包括规则数组及每条规则的详细参数。例如：

{
  "rules": [
    {
      "source": "recommended",
      "type": "MissingValueFill",
      "field": "FieldB",
      "method": "mean"
    },
    {
      "source": "custom",
      "type": "Encoding",
      "field": "FieldC",
      "method": "one-hot"
    },
    ...
  ]
}


上例表示有两条规则：第一条为推荐策略添加的缺失值填充（对字段FieldB采用均值），第二条为用户自定义的编码（对字段FieldC使用One-Hot编码）。

执行任务与结果：用户确认执行后，系统后台按照配置顺序依次应用清洗规则：

执行过程中，若某步骤发生错误（例如自定义填充值类型不匹配导致转换失败），系统应停止后续操作，标记任务失败，并在日志中记录错误原因。同时在前端提示用户相应错误，允许其修改配置后重试。

全部规则成功执行完毕后，系统将结果数据保存为新版本的数据集。版本号自动递增（例如原数据版本为v1，则清洗后生成v2），并记录该版本的来源为“清洗/预处理”、创建时间、创建人和应用的规则摘要等元数据。

前端跳转到新版本的详情页面，展示处理后的数据概览和规则摘要：包括字段总数、记录总数、缺失值比例、异常值比例等统计信息，以及预处理规则列表。用户可在此页面进行进一步验证。

系统在版本管理模块中添加该新版本记录，并支持用户随后在“版本历史”中进行对比：比如对比清洗前后字段变化（哪些字段被删除或新增，哪些字段类型改变）、数据统计差异（缺失率降低情况等）、以及规则配置差异。版本对比中对于新增字段高亮为绿色，删除字段为红色，改变的标记为黄色等，方便用户识别改动。

输出结构：规则配置完成并执行后，输出为一个新的数据版本以及相应的预处理任务记录。关键输出包括：

新数据版本：包含清洗后数据表（只保留选择的字段及处理后的值）。

版本元数据：版本号、来源=预处理、应用规则摘要、创建时间、创建人、数据量大小等。

处理日志：完整的预处理执行日志存储在系统中，可在任务详情或日志模块查看追溯。

任务结果摘要：用于页面展示的卡片信息，如字段数变化、缺失率变化、规则列表等（见上文）。

边界与异常场景：

无推荐策略：如果 LimiX 模型分析未发现明显的数据问题，智能推荐列表可能为空。界面应显示“未发现推荐清洗策略”字样，用户仍可通过手动添加规则或 LLM 指令来自行配置。

规则冲突：如果用户配置了相互冲突或重复的规则（例如对同一字段同时添加两种不同的缺失值填充），系统在“校验配置”时应给出警告或错误，要求用户调整。通常，同一字段不应配置重复处理动作，否则以后者为准或造成冲突。

参数非法：当某规则参数填写不正确（如文本填充方式输入了非数值到数值字段），点击开始执行时系统会立即校验并阻止执行，提示对应规则的错误项。JSON模式下亦如此，确保不合法配置无法提交。

长时间任务：对于数据量大的预处理任务，系统应确保有进度反馈且前端不会超时。可以将清洗任务放入后台队列，前端轮询任务状态。任务完成后以通知或自动刷新方式告知用户。

权限控制：预处理任务执行需要用户对涉及的数据集拥有编辑权限。如果在执行时检测到用户权限变更或不足（例如数据集已被其他人锁定），系统应中止任务并反馈“权限不足或数据不可用”。

回滚机制：如预处理结果不符合预期，用户可以通过版本管理进行“版本回退”。回退操作不会删除刚生成的版本，而是以之前的某版本数据复制生成一个新版本，实现恢复效果（例如从v3回退到v1的数据内容，系统会创建v4与v1相同）。该操作需记录日志以备审计。