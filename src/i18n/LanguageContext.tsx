import React, { createContext, useContext, useEffect, useMemo, useState } from "react";

export type Lang = "zh" | "en";

const messages: Record<Lang, Record<string, string>> = {
  zh: {
    "app.subtitle": "大模型机器学习平台",
    "nav.dashboard": "看板",
    "nav.project": "项目管理",
    "nav.data": "数据管理",
    "nav.task": "任务管理",
    "nav.model": "模型管理",
    "nav.system": "系统管理",
    "header.personalCenter": "个人中心",
    "header.personalization": "个性化设置",
    "header.version": "版本",
    "header.logout": "退出登录",
    "dashboard.globalStats": "全局统计看板",
    "dashboard.systemResource": "系统资源状态看板",
    "dashboard.recentActivity": "最近活动",
    "dashboard.recentProjects": "最近项目",
    "dashboard.quickActions": "快速操作",
    "dashboard.remainingTime": "剩余时间",
    "common.viewAll": "查看全部",
    "common.viewDetail": "查看详情",
    "common.welcomeBack": "欢迎回来",
    "common.reset": "重置",
    "common.view": "查看",
    "common.history": "版本历史",
    "common.quickPreprocess": "快速预处理",
    "common.download": "下载",
    "common.cancelUpload": "取消上传",
    "common.reupload": "重新上传",
    "common.min": "最小值",
    "common.max": "最大值",
    "common.cancel": "取消",
    "common.confirm": "确定",
    "common.apply": "应用",
    "common.save": "保存",
    "common.add": "添加",
    "common.clear": "清除",
    "common.clearAll": "清除全部",
    "common.prev": "上一页",
    "common.next": "下一页",
    "common.yes": "是",
    "common.no": "否",
    "common.noContent": "无内容",
    "status.inProgress": "进行中",
    "status.failed": "失败",
    "status.completed": "已完成",

    // 数据管理页
    "data.title": "数据管理",
    "data.description": "上传、管理和分析您的数据集，支持多种格式的结构化数据",
    "data.submenu.datasets": "数据集",
    "data.submenu.preprocessing": "数据预处理",
    "data.search.placeholder": "搜索数据集...",
    "data.status.all": "所有状态",
    "data.status.success": "成功",
    "data.status.processing": "导入中",
    "data.status.failed": "失败",
    "data.source.all": "所有来源",
    "data.source.upload": "上传",
    "data.source.subscription": "订阅",
    "data.source.api": "API",
    "data.source.database": "数据库",
    "data.dateRange.placeholder": "开始日期 - 结束日期",
    "data.filter.advanced": "高级筛选",
    "data.table.selectAllCurrent": "全选当前结果",
    "data.toolbar.uploadDataset": "上传数据集",
    "data.toolbar.newDatasource": "新增数据源",
    "data.toolbar.subscriptionMgmt": "订阅管理",
    "data.toolbar.batchDownload": "批量下载",
    "data.toolbar.batchArchive": "批量归档",
    "data.toolbar.batchDelete": "批量删除",
    "data.columns.name": "名称",
    "data.columns.description": "描述",
    "data.columns.tags": "标签",
    "data.columns.format": "格式",
    "data.columns.size": "大小",
    "data.columns.rows": "行数",
    "data.columns.columns": "列数",
    "data.columns.completeness": "完整度",
    "data.columns.source": "来源",
    "data.columns.version": "版本",
    "data.columns.updateTime": "更新时间",
    "data.columns.status": "状态",
    "data.columns.actions": "操作",
    "data.grid.format": "格式:",
    "data.grid.size": "大小:",
    "data.grid.rows": "行数:",
    "data.grid.columns": "列数:",
    "data.grid.completeness": "完整度",
    "data.statusBadge.success": "成功",
    "data.statusBadge.processing": "导入中",
    "data.statusBadge.failed": "失败",
    // 高级筛选与列设置（数据管理）
    "data.filter.title": "高级筛选",
    "data.filter.sizeRange": "大小范围 (MB)",
    "data.filter.rowsRange": "行数范围",
    "data.filter.completenessRange": "完整度范围",
    "data.filter.dateRange": "日期范围",
    "data.filter.tags": "标签（支持模糊搜索）",
    "data.filter.tags.placeholder": "输入标签关键字，例如：清洗、实时、CSV...",
    "data.filter.tags.noMatch": "无匹配标签",
    "data.filter.formats": "格式",
    "data.columnsSettings.title": "列设置",
    "data.columnsSettings.description": "选择要显示的列并调整顺序",
    "data.columnsSettings.selectAll": "全选",
    "data.stats.totalDatasets": "总数据集",
    "data.stats.uploadsToday": "今日上传",
    "data.stats.importing": "导入中",
    "data.stats.totalStorage": "总存储",
    "data.dialog.edit.title": "编辑数据集",
    "data.dialog.edit.description": "修改数据集的基本信息和配置",
    "data.dialog.copy.title": "复制数据集",
    "data.dialog.copy.description": "创建数据集的副本",
    "data.dialog.copy.createCopy": "创建副本",
    "data.form.name": "数据集名称",
    "data.form.source": "数据源",
    "data.form.description": "描述",
    "data.form.tags": "数据标签",
    "data.form.inputTagName": "输入标签名称",
    "data.form.format": "数据格式",
    "data.form.version": "版本",
    "data.toast.reuploadSuccess": "重新上传成功",
    "data.toast.reuploadSuccess.prefix": "数据集",
    "data.toast.reuploadSuccess.suffix": "已重新上传完成",
    "data.toast.uploadSuccess": "数据上传成功",
    "data.toast.uploadSuccess.prefix": "数据集",
    "data.toast.uploadSuccess.suffix": "已成功创建",
    "data.toast.datasourceCreateSuccess": "数据源创建成功",
    "data.toast.datasourceCreateSuccess.prefix": "数据源",
    "data.toast.datasourceCreateSuccess.suffix": "已成功创建并开始同步",
    "data.toast.copyRulesToTemplateSuccess": "已复制预处理规则为新模板",
    "data.toast.taskDeleteSuccess": "任务已删除",
    "data.toast.copyDatasetSuccess": "已复制数据集",
    "data.toast.filtersReset": "筛选条件已重置",
    "data.toast.cancelUploadSuccess": "已取消上传",
    "data.toast.prepareReupload": "准备重新上传",
    "data.toast.batchDeleteSuccess": "批量删除成功",
    "data.toast.datasetUpdateSuccess": "数据集已更新",
    "data.toast.downloadStart": "开始下载",
    "data.toast.batchDownloadStart": "开始批量下载",
    "data.toast.batchArchiveSuccess": "批量归档成功",
    "data.toast.refreshSuccess": "数据已刷新",
    "data.toast.taskStart": "任务已开始执行",
    "data.toast.taskStop": "任务已停止",
    "data.toast.taskRetry": "已重新开始处理任务",
    "data.toast.datasetNotFound": "数据集未找到",
    "data.toast.datasetNotFound.prefix": "数据集未找到：",
    "data.confirm.delete.title": "删除确认",
    "data.confirm.delete.message": "确定要删除选中的数据集吗？此操作不可恢复。",
    "data.confirm.delete.confirmButton": "确认删除",
    "data.confirm.cancelUpload.title": "取消上传确认",
    "data.confirm.cancelUpload.message": "确定要取消该数据集的上传吗？未完成的数据将被丢弃。",
    "data.pagination.page": "页",
    "data.pagination.itemsPerPage": "每页条数",
    "data.preprocessing.tasks": "预处理任务管理",
    "data.preprocessing.createTask": "创建预处理任务",
    "data.preprocessing.table.taskId": "任务ID",
    "data.preprocessing.table.dataset": "数据集",
    "data.preprocessing.table.type": "类型",
    "data.preprocessing.table.status": "状态",
    "data.preprocessing.table.operation": "操作内容",
    "data.preprocessing.table.startTime": "开始时间",
    "data.preprocessing.table.endTime": "完成时间",
    "data.preprocessing.table.actions": "操作",
    "task.filters.createdAtRange": "创建时间范围",
    // Task action buttons
    "task.actions.viewDetail": "查看详情",
    "task.actions.stop": "停止",
    "task.actions.start": "开始执行",
    "task.actions.edit": "编辑",
    "task.actions.delete": "删除",
    "task.actions.retry": "重试",
    "task.actions.copyRules": "复制规则",

    // 模型管理页
    "model.title": "模型管理",
    "model.description": "管理和部署您的AI模型",
    "model.compare": "模型对比",
    "model.refresh": "刷新",
    "model.view.grid": "网格视图",
    "model.view.list": "列表视图",
    "model.columnsSettings": "列设置",
    "model.tuning": "模型微调",
    "model.search.placeholder": "搜索模型名称或类型...",
    "model.filter.category": "分类筛选",
    "model.filter.category.all": "全部分类",
    "model.filter.category.classification": "分类",
    "model.filter.category.regression": "回归",
    "model.filter.category.dl": "深度学习",
    "model.filter.category.nlp": "NLP",
    "model.filter.status": "状态筛选",
    "model.filter.status.all": "全部状态",
    "model.filter.status.completed": "已完成",
    "model.filter.status.training": "训练中",
    "model.filter.status.pending": "待训练",

    // 任务管理页
    "task.title": "任务管理",
    "task.create": "创建任务",
    "task.saveChanges": "保存修改",
    "task.filters.title": "筛选条件",
    "task.filters.search": "搜索",
    "task.filters.search.placeholder": "搜索任务名称、ID等",
    "task.filters.type": "任务类型",
    "task.filters.type.all": "全部类型",
    "task.filters.status": "状态",
    "task.filters.status.all": "全部状态",
    "task.filters.status.pending": "排队中",
    "task.filters.status.running": "运行中",
    "task.filters.status.completed": "已完成",
    "task.filters.status.failed": "失败",
    "task.filters.status.cancelled": "已取消",
    "task.filters.status.archived": "已归档",
    "task.filters.project": "所属项目",
    "task.filters.project.all": "全部项目",
    "task.filters.priority": "优先级",
    "task.filters.priority.all": "全部优先级",
    "task.filters.priority.low": "低",
    "task.filters.priority.medium": "中",
    "task.filters.priority.high": "高",
    "task.filters.datasetName": "数据集名称",
    "task.filters.dataset.select": "筛选数据集",
    "task.filters.dataset.search": "搜索数据集...",
    "task.filters.dataset.empty": "未找到数据集",
    "task.filters.modelName": "模型名称",
    "task.filters.model.select": "筛选模型",
    "task.filters.model.search": "搜索模型...",
    "task.filters.model.empty": "未找到模型",

    // 项目管理相关（侧栏与项目详情卡片）
    "project.sidebar.title": "项目管理",
    "project.sidebar.desc": "创建新的产品和功能项目",
    "project.sidebar.newProject": "创建新项目",
    "project.sidebar.analysisInfo": "项目分析信息",
    "project.sidebar.analysisDesc": "基于人工智能数据智能化中的学习数据统计，赛场至关重要的体验统计",
    "project.cards.cycle": "周期",
    "project.cards.owner": "负责人",
    "project.cards.members": "成员",
    "project.cards.status": "状态",
    "project.cards.data.title": "数据管理",
    "project.cards.datasets": "数据集",
    "project.cards.mainDatasource": "主要数据源",
    "project.cards.importData": "导入数据管理",
    "project.cards.enterData": "进入数据管理",
    "project.cards.task.title": "任务管理",
    "project.cards.totalTasks": "总任务",
    "project.cards.completed": "已完成",
    "project.cards.currentTask": "当前任务:",
    "project.cards.enterTasks": "进入任务管理",
    "project.cards.model.title": "模型管理",
    "project.cards.modelsCount": "模型数量",
    "project.cards.mainModel": "主要模型:",
    "project.cards.enterModels": "进入模型管理",
    "project.cards.basicInfo": "基本信息",
    "project.cards.autoClean": "自动清洗",

    // 通用权限与可见性
    "permission.private": "私有",
    "permission.team": "团队",
    "permission.public": "公开",
    "data.visibility.publicData": "公开数据",
    "data.visibility.projectData": "项目内数据",
    "data.visibility.publicHint": "公开权限将允许非项目成员查看该数据（覆盖项目归属限制）",
    "data.visibility.projectMembersOnly": "仅项目成员可见",
    "data.visibility.note": "注意：所属项目为必填项；默认仅对项目成员可见；将权限设置为“公开”后，任何用户均可查看。",
    "data.form.project": "所属项目",
    "data.form.permission": "权限设置",
    "data.projects.noneSelected": "未选择项目",

    // 数据上传（DataUpload）
    "data.upload.title": "数据上传",
    "data.upload.description": "支持 CSV、Excel、JSON 格式，单文件最大 1GB",
    "data.upload.form.name.placeholder": "请输入数据集名称",
    "data.upload.form.project.placeholder": "请选择所属项目",
    "data.upload.form.description.placeholder": "请输入数据集的详细描述，包括数据内容、用途等信息",
    "data.upload.files.label": "文件上传",
    "data.upload.dragDrop.prompt": "拖拽文件到此处，或",
    "data.upload.dragDrop.select": "点击选择文件",
    "data.upload.fileList.label": "文件列表",
    "data.upload.status.uploading": "上传中",
    "data.upload.status.parsing": "解析中",
    "data.upload.status.success": "完成",
    "data.upload.status.error": "失败",
    "data.upload.status.pending": "等待上传",
    "data.upload.progress": "上传进度",
    "data.upload.parsingStructure": "正在解析文件结构...",
    "data.upload.parsedResult": "解析结果",
    "data.upload.rows": "行",
    "data.upload.columns": "列",
    "data.upload.table.fieldName": "字段名",
    "data.upload.table.type": "类型",
    "data.upload.table.missingValues": "缺失值",
    "data.upload.table.uniqueValues": "唯一值",
    "data.upload.table.example": "示例",
    "data.upload.preview": "数据预览",
    "data.upload.actions.start": "开始上传",
    "data.upload.actions.uploading": "上传中...",
    "data.upload.toast.tagExists": "标签已存在",
    "data.upload.toast.localSimulate": "已使用本地模拟处理（未配置大模型 API 密钥）",
    "data.upload.toast.planGenerated": "已根据语义指令生成处理方案",
    "data.upload.toast.semanticFailed": "语义指令处理失败",
    "data.upload.toast.nameRequired": "请输入数据集名称",
    "data.upload.toast.projectRequired": "请选择所属项目",
    "data.upload.toast.selectFiles": "请选择要上传的文件",
    "data.upload.toast.uploadSuccess": "数据上传成功",
    "data.upload.toast.uploadSuccessDescPrefix": "已成功上传",
    "data.upload.toast.uploadSuccessDescSuffix": "个文件",
    "data.upload.toast.uploadFailed": "上传失败",
    "data.upload.toast.checkNetwork": "请检查网络连接后重试",
    "data.upload.toast.uploadingWait": "上传进行中，请稍候",
    "data.upload.toast.unsupportedFormat": "文件格式不支持",
    "data.upload.toast.supportedFormatsDesc": "支持的格式：CSV、Excel、JSON",
    "data.upload.toast.sizeExceeded": "文件大小超过限制",
    "data.upload.toast.sizeLimitDesc": "文件大小不能超过 1GB",

    // 原型图与语音模块
    "data.upload.prototype.title": "原型图示例（流程预览）",
    "data.upload.prototype.step.analysis.name": "数据分析",
    "data.upload.prototype.step.analysis.desc": "字段类型识别、缺失值/异常值检测",
    "data.upload.prototype.step.strategy.name": "策略选择",
    "data.upload.prototype.step.strategy.desc": "按质量问题自动匹配最佳清洗方案",
    "data.upload.prototype.step.clean.name": "执行清洗",
    "data.upload.prototype.step.clean.desc": "规范化、补全、去重、异常修正",
    "data.upload.prototype.step.review.name": "查看结果",
    "data.upload.prototype.step.review.desc": "报告与预览，支持回滚与导出",
    "data.upload.prototype.autoModeHint": "自动模式会自动分析并清洗数据，您也可以通过语音指令微调策略。",

    "voice.input.title": "语音指令输入",
    "voice.status.idle": "空闲",
    "voice.status.listening": "监听中",
    "voice.status.processing": "初始化中",
    "voice.status.error": "异常",
    "voice.actions.startRecording": "开始录音",
    "voice.actions.stop": "停止",
    "voice.input.helper": "支持实时识别与显示，中文优先。",
    "voice.input.transcriptLabel": "实时识别文本",
    "voice.input.transcriptPlaceholder": "语音识别内容将实时显示在此，您可以继续录音或点击停止。",
    "voice.errors.browserNotSupported": "当前浏览器不支持语音识别",
    "voice.errors.recommendChromeEdge": "建议使用最新的 Chrome/Edge 浏览器",
    "voice.errors.cannotStart": "无法启动语音输入",
    "voice.errors.checkMicPermission": "请检查麦克风权限设置",

    // 数据源订阅（DataSubscription）
    "data.subscription.title": "新增数据源",
    "data.subscription.description": "支持MySQL、PostgreSQL、Oracle、CSV、Excel、JSON、API、MQTT等多种数据源，提供智能配置向导和实时连接测试。",
    "data.subscription.tabs.basic": "基本信息",
    "data.subscription.tabs.connection": "连接配置",
    "data.subscription.tabs.schedule": "同步设置",
    "data.subscription.form.name": "数据源名称",
    "data.subscription.form.name.placeholder": "请输入数据源名称",
    "data.subscription.form.type": "数据源类型",
    "data.subscription.form.type.placeholder": "请选择数据源类型",
    "data.subscription.form.description": "数据源描述",
    "data.subscription.form.description.placeholder": "请输入数据源的详细描述，包括数据内容、用途等信息",
    "data.subscription.sourceType.api": "API接口",
    "data.subscription.connection.titleSuffix": "连接配置",
    "data.subscription.connection.success": "连接成功",
    "data.subscription.connection.testing": "测试中...",
    "data.subscription.actions.testConnection": "测试连接",
    "data.subscription.schedule.title": "同步频率配置",
    "data.subscription.schedule.frequency": "同步频率",
    "data.subscription.schedule.daily": "每日",
    "data.subscription.schedule.hourly": "每小时",
    "data.subscription.schedule.every10min": "每10分钟",
    "data.subscription.schedule.advancedCron": "高级模式（Cron表达式）",
    "data.subscription.schedule.cron.placeholder": "0 0 * * * (每天午夜)",
    "data.subscription.schedule.cron.desc": "格式：秒 分 时 日 月 周，例如：0 0 12 * * * 表示每天中午12点",
    "data.subscription.actions.create": "创建数据源",
    "data.subscription.actions.creating": "创建中...",
    "data.subscription.toast.testSuccess": "连接测试成功",
    "data.subscription.toast.testSuccessDesc": "数据源连接正常，可以创建订阅",
    "data.subscription.toast.testFailed": "连接测试失败",
    "data.subscription.toast.testFailedDesc": "请检查配置信息后重试",
    "data.subscription.toast.networkError": "网络错误，请稍后重试",
    "data.subscription.toast.nameRequired": "请输入订阅名称",
    "data.subscription.toast.projectRequired": "请选择所属项目",
    "data.subscription.toast.requireTestSuccess": "请先测试连接成功后再创建订阅",
    "data.subscription.toast.createSuccess": "订阅创建成功",
    "data.subscription.toast.createFailed": "创建订阅失败",
    "data.subscription.toast.createFailedDesc": "请稍后重试",
    "data.subscription.toast.creatingWait": "正在创建订阅，请稍候",
    "data.subscription.toast.createSuccessDescPrefix": "订阅",
    "data.subscription.toast.createSuccessDescSuffix": "已成功创建",
    "data.subscription.toast.visibility.public": "公开（非项目成员可查看）",
    "data.subscription.toast.visibility.project": "项目内（成员可见）",

    // 数据源字段（连接配置表单）
    "data.subscription.fields.host": "主机地址",
    "data.subscription.fields.port": "端口",
    "data.subscription.fields.database": "数据库名",
    "data.subscription.fields.username": "用户名",
    "data.subscription.fields.password": "密码",
    "data.subscription.fields.query": "查询语句",
    "data.subscription.fields.uri": "连接URI",
    "data.subscription.fields.collection": "集合",
    "data.subscription.fields.filter": "过滤条件",
    "data.subscription.fields.keyPattern": "Key 模式",
    "data.subscription.fields.index": "索引",
    "data.subscription.fields.authType": "认证方式",
    "data.subscription.fields.auth.none": "无认证",
    "data.subscription.fields.auth.basic": "用户名密码",
    "data.subscription.fields.auth.apikey": "API Key",
    "data.subscription.fields.api.url": "API URL",
    "data.subscription.fields.api.method": "请求方法",
    "data.subscription.fields.api.headers": "请求头",
    "data.subscription.fields.api.params": "请求参数",
    "data.subscription.fields.api.auth.basic": "Basic Auth",
    "data.subscription.fields.api.auth.bearer": "Bearer Token",
    "data.subscription.fields.api.auth.apikey": "API Key",
    "data.subscription.fields.api.auth.value": "认证值",
    "data.subscription.fields.ftp.host": "服务器地址",
    "data.subscription.fields.ftp.path": "文件路径",
    "data.subscription.fields.ftp.fileType": "文件类型",
    "data.subscription.fields.ftp.fileType.all": "所有类型",
  },
  en: {
    "app.subtitle": "AI-powered ML Platform",
    "nav.dashboard": "Dashboard",
    "nav.project": "Projects",
    "nav.data": "Data",
    "nav.task": "Tasks",
    "nav.model": "Models",
    "nav.system": "System",
    "header.personalCenter": "Profile",
    "header.personalization": "Personalization Settings",
    "header.version": "Version",
    "header.logout": "Logout",
    "dashboard.globalStats": "Global Stats",
    "dashboard.systemResource": "System Resource Status",
    "dashboard.recentActivity": "Recent Activity",
    "dashboard.recentProjects": "Recent Projects",
    "dashboard.quickActions": "Quick Actions",
    "dashboard.remainingTime": "Remaining Time",
    "common.viewAll": "View All",
    "common.viewDetail": "View Details",
    "common.welcomeBack": "Welcome Back",
    "common.reset": "Reset",
    "common.view": "View",
    "common.history": "Version History",
    "common.quickPreprocess": "Quick Preprocess",
    "common.download": "Download",
    "common.cancelUpload": "Cancel Upload",
    "common.reupload": "Re-upload",
    "common.min": "Min",
    "common.max": "Max",
    "common.cancel": "Cancel",
    "common.confirm": "Confirm",
    "common.apply": "Apply",
    "common.save": "Save",
    "common.add": "Add",
    "common.clear": "Clear",
    "common.clearAll": "Clear All",
    "common.prev": "Previous",
    "common.next": "Next",
    "common.yes": "Yes",
    "common.no": "No",
    "common.noContent": "No content",
    "status.inProgress": "In Progress",
    "status.failed": "Failed",
    "status.completed": "Completed",

    // Data Management
    "data.title": "Data Management",
    "data.description": "Upload, manage, and analyze datasets; supports multiple structured formats",
    "data.submenu.datasets": "Datasets",
    "data.submenu.preprocessing": "Data Preprocessing",
    "data.search.placeholder": "Search datasets...",
    "data.status.all": "All Statuses",
    "data.status.success": "Success",
    "data.status.processing": "Importing",
    "data.status.failed": "Failed",
    "data.source.all": "All Sources",
    "data.source.upload": "Upload",
    "data.source.subscription": "Subscription",
    "data.source.api": "API",
    "data.source.database": "Database",
    "data.dateRange.placeholder": "Start date - End date",
    "data.filter.advanced": "Advanced Filter",
    "data.table.selectAllCurrent": "Select all current results",
    "data.toolbar.uploadDataset": "Upload Dataset",
    "data.toolbar.newDatasource": "Add Datasource",
    "data.toolbar.subscriptionMgmt": "Subscriptions",
    "data.toolbar.batchDownload": "Batch Download",
    "data.toolbar.batchArchive": "Batch Archive",
    "data.toolbar.batchDelete": "Batch Delete",
    "data.columns.name": "Name",
    "data.columns.description": "Description",
    "data.columns.tags": "Tags",
    "data.columns.format": "Format",
    "data.columns.size": "Size",
    "data.columns.rows": "Rows",
    "data.columns.columns": "Columns",
    "data.columns.completeness": "Completeness",
    "data.columns.source": "Source",
    "data.columns.version": "Version",
    "data.columns.updateTime": "Updated At",
    "data.columns.status": "Status",
    "data.columns.actions": "Actions",
    "data.grid.format": "Format:",
    "data.grid.size": "Size:",
    "data.grid.rows": "Rows:",
    "data.grid.columns": "Columns:",
    "data.grid.completeness": "Completeness",
    "data.statusBadge.success": "Success",
    "data.statusBadge.processing": "Importing",
    "data.statusBadge.failed": "Failed",
    // Advanced filter & column settings (Data Mgmt)
    "data.filter.title": "Advanced Filter",
    "data.filter.sizeRange": "Size Range (MB)",
    "data.filter.rowsRange": "Rows Range",
    "data.filter.completenessRange": "Completeness Range",
    "data.filter.dateRange": "Date Range",
    "data.filter.tags": "Tags (fuzzy search supported)",
    "data.filter.tags.placeholder": "Enter tag keywords, e.g., cleanse, real-time, CSV...",
    "data.filter.tags.noMatch": "No matching tags",
    "data.filter.formats": "Formats",
    "data.columnsSettings.title": "Column Settings",
    "data.columnsSettings.description": "Choose columns to display and adjust order",
    "data.columnsSettings.selectAll": "Select All",
    "data.stats.totalDatasets": "Total Datasets",
    "data.stats.uploadsToday": "Uploads Today",
    "data.stats.importing": "Importing",
    "data.stats.totalStorage": "Total Storage",
    "data.dialog.edit.title": "Edit Dataset",
    "data.dialog.edit.description": "Modify dataset basic information and configuration",
    "data.dialog.copy.title": "Copy Dataset",
    "data.dialog.copy.description": "Create a copy of the dataset",
    "data.dialog.copy.createCopy": "Create Copy",
    "data.form.name": "Dataset Name",
    "data.form.source": "Data Source",
    "data.form.description": "Description",
    "data.form.tags": "Data Tags",
    "data.form.inputTagName": "Enter tag name",
    "data.form.format": "Data Format",
    "data.form.version": "Version",
    "data.toast.reuploadSuccess": "Re-upload Successful",
    "data.toast.reuploadSuccess.prefix": "Dataset",
    "data.toast.reuploadSuccess.suffix": "re-uploaded successfully",
    "data.toast.uploadSuccess": "Upload Successful",
    "data.toast.uploadSuccess.prefix": "Dataset",
    "data.toast.uploadSuccess.suffix": "created successfully",
    "data.toast.datasourceCreateSuccess": "Datasource Created",
    "data.toast.datasourceCreateSuccess.prefix": "Datasource",
    "data.toast.datasourceCreateSuccess.suffix": "created successfully and started syncing",
    "data.toast.copyRulesToTemplateSuccess": "Copied preprocessing rules to new template",
    "data.toast.taskDeleteSuccess": "Task deleted",
    "data.toast.copyDatasetSuccess": "Dataset copied",
    "data.toast.filtersReset": "Filters reset",
    "data.toast.cancelUploadSuccess": "Upload cancelled",
    "data.toast.prepareReupload": "Prepare to re-upload",
    "data.toast.batchDeleteSuccess": "Batch delete successful",
    "data.toast.datasetUpdateSuccess": "Dataset updated",
    "data.toast.downloadStart": "Starting download",
    "data.toast.batchDownloadStart": "Starting batch download",
    "data.toast.batchArchiveSuccess": "Batch archive successful",
    "data.toast.refreshSuccess": "Data refreshed",
    "data.toast.taskStart": "Task started",
    "data.toast.taskStop": "Task stopped",
    "data.toast.taskRetry": "Task restarted",
    "data.toast.datasetNotFound": "Dataset not found",
    "data.toast.datasetNotFound.prefix": "Dataset not found:",
    "data.confirm.delete.title": "Delete Confirmation",
    "data.confirm.delete.message": "Are you sure you want to delete the selected datasets? This action cannot be undone.",
    "data.confirm.delete.confirmButton": "Delete",
    "data.confirm.cancelUpload.title": "Cancel Upload",
    "data.confirm.cancelUpload.message": "Are you sure you want to cancel the dataset upload? Incomplete data will be discarded.",
    "data.pagination.page": "Page",
    "data.pagination.itemsPerPage": "Items per page",
    "data.preprocessing.tasks": "Preprocessing Task Management",
    "data.preprocessing.createTask": "Create Preprocessing Task",
    "data.preprocessing.table.taskId": "Task ID",
    "data.preprocessing.table.dataset": "Dataset",
    "data.preprocessing.table.type": "Type",
    "data.preprocessing.table.status": "Status",
    "data.preprocessing.table.operation": "Operation",
    "data.preprocessing.table.startTime": "Start Time",
    "data.preprocessing.table.endTime": "End Time",
    "data.preprocessing.table.actions": "Actions",
    "task.filters.createdAtRange": "Created Time Range",
    // Task action buttons
    "task.actions.viewDetail": "View Details",
    "task.actions.stop": "Stop",
    "task.actions.start": "Start",
    "task.actions.edit": "Edit",
    "task.actions.delete": "Delete",
    "task.actions.retry": "Retry",
    "task.actions.copyRules": "Copy Rules",

    // Model Management
    "model.title": "Model Management",
    "model.description": "Manage and deploy your AI models",
    "model.compare": "Compare Models",
    "model.refresh": "Refresh",
    "model.view.grid": "Grid View",
    "model.view.list": "List View",
    "model.columnsSettings": "Column Settings",
    "model.tuning": "Model Fine-tuning",
    "model.search.placeholder": "Search model name or type...",
    "model.filter.category": "Category Filter",
    "model.filter.category.all": "All Categories",
    "model.filter.category.classification": "Classification",
    "model.filter.category.regression": "Regression",
    "model.filter.category.dl": "Deep Learning",
    "model.filter.category.nlp": "NLP",
    "model.filter.status": "Status Filter",
    "model.filter.status.all": "All Statuses",
    "model.filter.status.completed": "Completed",
    "model.filter.status.training": "Training",
    "model.filter.status.pending": "Pending",

    // Task Management
    "task.title": "Task Management",
    "task.create": "Create Task",
    "task.saveChanges": "Save Changes",
    "task.filters.title": "Filters",
    "task.filters.search": "Search",
    "task.filters.search.placeholder": "Search task name, ID, etc.",
    "task.filters.type": "Task Type",
    "task.filters.type.all": "All Types",
    "task.filters.status": "Status",
    "task.filters.status.all": "All Statuses",
    "task.filters.status.pending": "Pending",
    "task.filters.status.running": "Running",
    "task.filters.status.completed": "Completed",
    "task.filters.status.failed": "Failed",
    "task.filters.status.cancelled": "Cancelled",
    "task.filters.status.archived": "Archived",
    "task.filters.project": "Project",
    "task.filters.project.all": "All Projects",
    "task.filters.priority": "Priority",
    "task.filters.priority.all": "All Priorities",
    "task.filters.priority.low": "Low",
    "task.filters.priority.medium": "Medium",
    "task.filters.priority.high": "High",
    "task.filters.datasetName": "Dataset Name",
    "task.filters.dataset.select": "Select Datasets",
    "task.filters.dataset.search": "Search datasets...",
    "task.filters.dataset.empty": "No datasets found",
    "task.filters.modelName": "Model Name",
    "task.filters.model.select": "Select Models",
    "task.filters.model.search": "Search models...",
    "task.filters.model.empty": "No models found",

    // Project related (sidebar & project detail cards)
    "project.sidebar.title": "Project Management",
    "project.sidebar.desc": "Create new product and feature projects",
    "project.sidebar.newProject": "Create New Project",
    "project.sidebar.analysisInfo": "Project Analysis Info",
    "project.sidebar.analysisDesc": "AI-driven learning data statistics; key experience metrics",
    "project.cards.cycle": "Cycle",
    "project.cards.owner": "Owner",
    "project.cards.members": "Members",
    "project.cards.status": "Status",
    "project.cards.data.title": "Data Management",
    "project.cards.datasets": "Datasets",
    "project.cards.mainDatasource": "Main Datasource",
    "project.cards.importData": "Import to Data Mgmt",
    "project.cards.enterData": "Go to Data Mgmt",
    "project.cards.task.title": "Task Management",
    "project.cards.totalTasks": "Total Tasks",
    "project.cards.completed": "Completed",
    "project.cards.currentTask": "Current Task:",
    "project.cards.enterTasks": "Go to Task Mgmt",
    "project.cards.model.title": "Model Management",
    "project.cards.modelsCount": "Models Count",
    "project.cards.mainModel": "Primary Model:",
    "project.cards.enterModels": "Go to Model Mgmt",
    "project.cards.basicInfo": "Basic Info",
    "project.cards.autoClean": "Auto Cleaning",

    // Common permissions & visibility
    "permission.private": "Private",
    "permission.team": "Team",
    "permission.public": "Public",
    "data.visibility.publicData": "Public Data",
    "data.visibility.projectData": "Project Data",
    "data.visibility.publicHint": "Public permission allows non-project members to view this data (overrides project restriction).",
    "data.visibility.projectMembersOnly": "Visible only to project members",
    "data.visibility.note": "Note: Project is required; by default only project members can view; set permission to 'Public' to allow anyone to view.",
    "data.form.project": "Project",
    "data.form.permission": "Permission",
    "data.projects.noneSelected": "No project selected",

    // Data Upload (DataUpload)
    "data.upload.title": "Data Upload",
    "data.upload.description": "Supports CSV, Excel, JSON formats; max 1GB per file",
    "data.upload.form.name.placeholder": "Enter dataset name",
    "data.upload.form.project.placeholder": "Select project",
    "data.upload.form.description.placeholder": "Enter detailed dataset description, including contents and purpose",
    "data.upload.files.label": "File Upload",
    "data.upload.dragDrop.prompt": "Drag files here, or",
    "data.upload.dragDrop.select": "Click to choose files",
    "data.upload.fileList.label": "File List",
    "data.upload.status.uploading": "Uploading",
    "data.upload.status.parsing": "Parsing",
    "data.upload.status.success": "Completed",
    "data.upload.status.error": "Failed",
    "data.upload.status.pending": "Pending Upload",
    "data.upload.progress": "Upload Progress",
    "data.upload.parsingStructure": "Parsing file structure...",
    "data.upload.parsedResult": "Parsed Result",
    "data.upload.rows": "Rows",
    "data.upload.columns": "Columns",
    "data.upload.table.fieldName": "Field Name",
    "data.upload.table.type": "Type",
    "data.upload.table.missingValues": "Missing Values",
    "data.upload.table.uniqueValues": "Unique Values",
    "data.upload.table.example": "Example",
    "data.upload.preview": "Data Preview",
    "data.upload.actions.start": "Start Upload",
    "data.upload.actions.uploading": "Uploading...",
    "data.upload.toast.tagExists": "Tag already exists",
    "data.upload.toast.localSimulate": "Using local simulation (LLM API key not configured)",
    "data.upload.toast.planGenerated": "Plan generated based on semantic instruction",
    "data.upload.toast.semanticFailed": "Semantic instruction processing failed",
    "data.upload.toast.nameRequired": "Please enter dataset name",
    "data.upload.toast.projectRequired": "Please select a project",
    "data.upload.toast.selectFiles": "Please select files to upload",
    "data.upload.toast.uploadSuccess": "Upload Successful",
    "data.upload.toast.uploadSuccessDescPrefix": "Successfully uploaded",
    "data.upload.toast.uploadSuccessDescSuffix": "files",
    "data.upload.toast.uploadFailed": "Upload failed",
    "data.upload.toast.checkNetwork": "Please check network connection and retry",
    "data.upload.toast.uploadingWait": "Upload in progress, please wait",
    "data.upload.toast.unsupportedFormat": "Unsupported file format",
    "data.upload.toast.supportedFormatsDesc": "Supported formats: CSV, Excel, JSON",
    "data.upload.toast.sizeExceeded": "File size exceeds limit",
    "data.upload.toast.sizeLimitDesc": "Max file size is 1GB",

    // Prototype & Voice module
    "data.upload.prototype.title": "Prototype Preview (Flow)",
    "data.upload.prototype.step.analysis.name": "Data Analysis",
    "data.upload.prototype.step.analysis.desc": "Field type recognition, missing/outlier detection",
    "data.upload.prototype.step.strategy.name": "Strategy Selection",
    "data.upload.prototype.step.strategy.desc": "Automatically match best cleansing strategy based on data quality",
    "data.upload.prototype.step.clean.name": "Execute Cleansing",
    "data.upload.prototype.step.clean.desc": "Normalization, filling, deduplication, anomaly correction",
    "data.upload.prototype.step.review.name": "View Results",
    "data.upload.prototype.step.review.desc": "Report and preview, supports rollback and export",
    "data.upload.prototype.autoModeHint": "Auto mode analyzes and cleanses data; you can fine-tune via voice commands.",

    "voice.input.title": "Voice Command Input",
    "voice.status.idle": "Idle",
    "voice.status.listening": "Listening",
    "voice.status.processing": "Initializing",
    "voice.status.error": "Error",
    "voice.actions.startRecording": "Start Recording",
    "voice.actions.stop": "Stop",
    "voice.input.helper": "Supports real-time recognition and display; Chinese preferred.",
    "voice.input.transcriptLabel": "Transcribed Text",
    "voice.input.transcriptPlaceholder": "Recognized speech will display here in real time; you may continue recording or click Stop.",
    "voice.errors.browserNotSupported": "Your browser does not support speech recognition",
    "voice.errors.recommendChromeEdge": "Please use the latest Chrome/Edge",
    "voice.errors.cannotStart": "Unable to start voice input",
    "voice.errors.checkMicPermission": "Please check microphone permissions",

    // Data Subscription (DataSubscription)
    "data.subscription.title": "Add Datasource",
    "data.subscription.description": "Supports MySQL, PostgreSQL, Oracle, CSV, Excel, JSON, API, MQTT and more; provides guided setup and real-time connection testing.",
    "data.subscription.tabs.basic": "Basic Info",
    "data.subscription.tabs.connection": "Connection",
    "data.subscription.tabs.schedule": "Schedule",
    "data.subscription.form.name": "Datasource Name",
    "data.subscription.form.name.placeholder": "Enter datasource name",
    "data.subscription.form.type": "Datasource Type",
    "data.subscription.form.type.placeholder": "Select datasource type",
    "data.subscription.form.description": "Datasource Description",
    "data.subscription.form.description.placeholder": "Enter detailed datasource description, including contents and purpose",
    "data.subscription.sourceType.api": "API Interface",
    "data.subscription.connection.titleSuffix": "Connection Settings",
    "data.subscription.connection.success": "Connection Success",
    "data.subscription.connection.testing": "Testing...",
    "data.subscription.actions.testConnection": "Test Connection",
    "data.subscription.schedule.title": "Sync Frequency Settings",
    "data.subscription.schedule.frequency": "Sync Frequency",
    "data.subscription.schedule.daily": "Daily",
    "data.subscription.schedule.hourly": "Hourly",
    "data.subscription.schedule.every10min": "Every 10 minutes",
    "data.subscription.schedule.advancedCron": "Advanced Mode (Cron Expression)",
    "data.subscription.schedule.cron.placeholder": "0 0 * * * (midnight daily)",
    "data.subscription.schedule.cron.desc": "Format: sec min hour day month week, e.g., 0 0 12 * * * means 12:00 PM daily",
    "data.subscription.actions.create": "Create Datasource",
    "data.subscription.actions.creating": "Creating...",
    "data.subscription.toast.testSuccess": "Connection test successful",
    "data.subscription.toast.testSuccessDesc": "Datasource connection OK; you can create subscription",
    "data.subscription.toast.testFailed": "Connection test failed",
    "data.subscription.toast.testFailedDesc": "Please check configuration and retry",
    "data.subscription.toast.networkError": "Network error, please try again later",
    "data.subscription.toast.nameRequired": "Please enter subscription name",
    "data.subscription.toast.projectRequired": "Please select a project",
    "data.subscription.toast.requireTestSuccess": "Please test connection successfully before creating subscription",
    "data.subscription.toast.createSuccess": "Subscription created",
    "data.subscription.toast.createFailed": "Create subscription failed",
    "data.subscription.toast.createFailedDesc": "Please try again later",
    "data.subscription.toast.creatingWait": "Creating subscription, please wait",
    "data.subscription.toast.createSuccessDescPrefix": "Subscription",
    "data.subscription.toast.createSuccessDescSuffix": "created successfully",
    "data.subscription.toast.visibility.public": "Public (non-project members can view)",
    "data.subscription.toast.visibility.project": "Project-only (members visible)",

    // Connection form fields
    "data.subscription.fields.host": "Host",
    "data.subscription.fields.port": "Port",
    "data.subscription.fields.database": "Database",
    "data.subscription.fields.username": "Username",
    "data.subscription.fields.password": "Password",
    "data.subscription.fields.query": "Query",
    "data.subscription.fields.uri": "Connection URI",
    "data.subscription.fields.collection": "Collection",
    "data.subscription.fields.filter": "Filter",
    "data.subscription.fields.keyPattern": "Key Pattern",
    "data.subscription.fields.index": "Index",
    "data.subscription.fields.authType": "Auth Type",
    "data.subscription.fields.auth.none": "No Auth",
    "data.subscription.fields.auth.basic": "Username & Password",
    "data.subscription.fields.auth.apikey": "API Key",
    "data.subscription.fields.api.url": "API URL",
    "data.subscription.fields.api.method": "Method",
    "data.subscription.fields.api.headers": "Headers",
    "data.subscription.fields.api.params": "Params",
    "data.subscription.fields.api.auth.basic": "Basic Auth",
    "data.subscription.fields.api.auth.bearer": "Bearer Token",
    "data.subscription.fields.api.auth.apikey": "API Key",
    "data.subscription.fields.api.auth.value": "Auth Value",
    "data.subscription.fields.ftp.host": "Server Address",
    "data.subscription.fields.ftp.path": "File Path",
    "data.subscription.fields.ftp.fileType": "File Type",
    "data.subscription.fields.ftp.fileType.all": "All Types",
  },
};

type LanguageContextValue = {
  lang: Lang;
  setLang: (lang: Lang) => void;
  toggleLang: () => void;
  t: (key: string) => string;
};

const LanguageContext = createContext<LanguageContextValue | null>(null);

export function LanguageProvider({ children }: { children: React.ReactNode }) {
  const [lang, setLangState] = useState<Lang>(() => {
    try {
      const stored = localStorage.getItem("lang");
      if (stored === "zh" || stored === "en") return stored as Lang;
    } catch {}
    const n = typeof navigator !== "undefined" ? navigator.language?.toLowerCase() : "zh";
    return n && n.startsWith("zh") ? "zh" : "en";
  });

  const setLang = (l: Lang) => {
    setLangState(l);
    try { localStorage.setItem("lang", l); } catch {}
    if (typeof document !== "undefined") {
      document.documentElement.lang = l === "zh" ? "zh-CN" : "en";
    }
  };

  useEffect(() => {
    if (typeof document !== "undefined") {
      document.documentElement.lang = lang === "zh" ? "zh-CN" : "en";
    }
  }, [lang]);

  const toggleLang = () => setLang(lang === "zh" ? "en" : "zh");

  const t = (key: string) => {
    const zh = messages.zh[key];
    const en = messages.en[key];
    return (lang === "zh" ? zh : en) ?? zh ?? key;
  };

  const value = useMemo(() => ({ lang, setLang, toggleLang, t }), [lang]);

  return (
    <LanguageContext.Provider value={value}>
      {children}
    </LanguageContext.Provider>
  );
}

export function useLanguage() {
  const ctx = useContext(LanguageContext);
  if (!ctx) throw new Error("useLanguage must be used within LanguageProvider");
  return ctx;
}